AV Storage Metadata
===================

This is a binary format and should be stored next to any AV file output by the Sources or Sinks.

.. _file_header:

File Header
-----------

+------------+------+--------------------+----------------------------+
|   Offset   | Size | Description        |    Values                  |
+============+======+====================+============================+
| ``0x00``   | 1    | Version            |  - ``0x00`` - Version 0    |
+------------+------+--------------------+----------------------------+
| ``0x01``   | 1    | Type               |  - ``0x00`` - Video(MJPEG) |
|            |      |                    |  - ``0x01`` - Audio(PCM)   |
+------------+------+--------------------+----------------------------+
| ``0x02``   | 1    | Hash Algorithm     |  - ``0x00`` - SHA1         |
|            |      |                    |  - ``0x01`` - SHA224       |
|            |      |                    |  - ``0x02`` - SHA256       |
|            |      |                    |  - ``0x03`` - SHA384       |
|            |      |                    |  - ``0x04`` - SHA512       |
+------------+------+--------------------+----------------------------+
| ``0x03``   | 5    | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x08``   | 8    | File start         |                            |
|            |      | time [#time]_      |                            |
|            |      | [#num]_            |                            |
+------------+------+--------------------+----------------------------+
| ``0x10``   | 16   | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x20``   | 32   | Source Name        |                            |
|            |      | [#str]_            |                            |
+------------+------+--------------------+----------------------------+
| ``0x40``   | 64   | Type Headers       |                            |
+------------+------+--------------------+----------------------------+
| ``0x80``   | ...  | Frame Information  |                            |
+------------+------+--------------------+----------------------------+


.. _type_header:

Type Header(Per format)
-----------------------

.. _video_mjpeg_type_header:

(``type = 0x00``)Motion JPEG Video
``````````````````````````````````

+------------+------+--------------------+----------------------------+
|   Offset   | Size | Description        |    Values                  |
+============+======+====================+============================+
| ``0x00``   | 1    | Version            |  - ``0x00`` - Version 0    |
+------------+------+--------------------+----------------------------+
| ``0x01``   | 1    | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x02``   | 2    | Horizontal Size    |                            |
|            |      | (Pixels) [#num]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x04``   | 2    | Vertical Size      |                            |
|            |      | (Pixels) [#num]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x06``   | 2    | Frame Rate [#num]_ |                            |
+------------+------+--------------------+----------------------------+
| ``0x08``   | 56   | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+


(``type = 0x01``)PCM Audio
``````````````````````````

+------------+------+--------------------+----------------------------+
|   Offset   | Size | Description        |    Values                  |
+============+======+====================+============================+
| ``0x00``   | 1    | Version            |  - ``0x00`` - Version 0    |
+------------+------+--------------------+----------------------------+
| ``0x01``   | 1    | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+
| ``0x02``   | 2    | No. of Channels    |                            |
|            |      | [#num]_            |                            |
+------------+------+--------------------+----------------------------+
| ``0x04``   | 4    | Sample Rate        |                            |
|            |      | [#num]_            |                            |
+------------+------+--------------------+----------------------------+
| ``0x08``   | 2    | Bits per Sample    |                            |
|            |      | [#num]_            |                            |
+------------+------+--------------------+----------------------------+
| ``0x0A``   | 54   | Reserved [#rsv]_   |                            |
+------------+------+--------------------+----------------------------+



.. rubric:: Footnotes

.. [#rsv]  Reserved blocks should be zeroed when written and ignored when reading.
.. [#time] Time is represented as UTC seconds since epoch.
.. [#num]  Multi-byte field are big-edian.
.. [#str]  Strings are ASCII and not neccessarily null terminated. Null padding should be used when
           the string is shorter than the field.
